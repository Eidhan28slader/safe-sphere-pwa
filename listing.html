<script type="module">
import { db, collection, onSnapshot, query, orderBy } from "./firebase.js";

const postsBox = document.getElementById("posts");

const houseImages = [
  "assets/houses/house1.jpg",
  "assets/houses/house2.jpg",
  "assets/houses/house3.jpg",
  "assets/houses/house4.jpg",
  "assets/houses/house5.jpg"
];

function getRandomImage() {
  return houseImages[Math.floor(Math.random() * houseImages.length)];
}

onSnapshot(
  query(collection(db, "posts"), orderBy("createdAt", "desc")),
  snapshot => {
    postsBox.innerHTML = "";

    let hasData = false;

    snapshot.forEach(doc => {
      const p = doc.data();
      if (p.status !== "approved") return;

      hasData = true;

      const img = getRandomImage();
      console.log("IMG LOADED:", img); // ðŸ‘ˆ VERIFICAR EN CONSOLA

      postsBox.innerHTML += `
        <div class="card">
          <img src="${img}" style="width:100%; height:260px; object-fit:cover; border-radius:12px;">
          <div class="card-body">
            <h3>${p.title}</h3>
            <p>${p.desc}</p>
            <p><strong>Price:</strong> $${p.price}</p>
            <span class="badge verified">Approved</span>
          </div>
        </div>
      `;
    });

    if (!hasData) {
      postsBox.innerHTML = "<p>No approved posts yet.</p>";
    }
  }
);
</script>

