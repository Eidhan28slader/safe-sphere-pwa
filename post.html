<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SafeSphere - Post</title>
  <link rel="stylesheet" href="styles.css">

  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0b1830">
</head>
<body>

<nav>
  <img src="assets/logo.png" class="logo" alt="logo">
  <a href="index.html">Home</a>
  <a href="listing.html">Listing</a>
  <a href="post.html">Post</a>
  <a href="admin.html">Admin</a>
</nav>

<section class="section-box">
  <h2>Create New Listing</h2>

  <input id="title" placeholder="Title">

  <textarea id="desc" placeholder="Description"></textarea>

  <input id="price" type="number" placeholder="Price">

  <button id="publishBtn">Publish</button>
</section>

<!-- SCRIPT -->
<script type="module">
import { db, collection, addDoc, serverTimestamp } from "./firebase.js";

document.getElementById("publishBtn").addEventListener("click", createPost);

async function createPost() {
    const title = document.getElementById("title").value.trim();
    const desc = document.getElementById("desc").value.trim();
    const price = document.getElementById("price").value.trim();

    if (!title || !desc || !price) {
        alert("Please fill all fields");
        return;
    }

    await addDoc(collection(db, "posts"), {
        title,
        desc,
        price,
        status: "pending",
        createdAt: serverTimestamp()
    });

    alert("Listing sent! Wait for admin approval.");
    window.location.href = "listing.html";
}
</script>

</body>
</html>
