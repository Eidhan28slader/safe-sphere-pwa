<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SafeSphere - Roommates</title>
    <link rel="stylesheet" href="/safe-sphere-pwa/styles.css">
</head>

<body>

<nav>
    <img src="/safe-sphere-pwa/assets/logo.png" class="logo" alt="SafeSphere logo">
    <a href="/safe-sphere-pwa/index.html">Home</a>
    <a href="/safe-sphere-pwa/listing.html">Listing</a>
    <a href="/safe-sphere-pwa/post.html">Post</a>
    <a href="/safe-sphere-pwa/admin.html">Admin</a>
    <a href="/safe-sphere-pwa/roommates.html" class="active">Roommates</a>
    <a href="/safe-sphere-pwa/feedback.html">Feedback</a>
    <a href="/safe-sphere-pwa/add-roommate.html">Add Roommate</a>
</nav>

<main>

<section class="section-box">
    <h2>Find Roommates</h2>
    <p>See students looking for shared housing.</p>
</section>

<section id="roommates-container" class="listings-container">
    <p>Loading...</p>
</section>

</main>

<!-- SCRIPT ROOMMATES -->
<script type="module">
import {
    db,
    collection,
    query,
    orderBy,
    onSnapshot
} from "/safe-sphere-pwa/firebase.js";

const container = document.getElementById("roommates-container");

const roommatesRef = collection(db, "roommates");

onSnapshot(
    query(roommatesRef, orderBy("createdAt", "desc")),
    (snap) => {
        container.innerHTML = "";

        if (snap.empty) {
            container.innerHTML = "<p>No roommates found.</p>";
            return;
        }

        snap.forEach(doc => {
            const r = doc.data();

            container.innerHTML += `
                <div class="card">

                    <div class="roommate-card-img-wrapper">
                        <img 
                            src="${r.photo || '/safe-sphere-pwa/assets/roommates/default.jpg'}"
                            class="roommate-img"
                            alt="Roommate"
                        />
                    </div>

                    <h3>${r.name || "Unnamed"}</h3>
                    <p>${r.bio || "No biography provided."}</p>

                    <p><b>Budget:</b> $${r.budget || "Unknown"}</p>
                    <p><b>Age:</b> ${r.age || "Unknown"}</p>
                </div>
            `;
        });
    }
);
</script>

</body>
</html>

